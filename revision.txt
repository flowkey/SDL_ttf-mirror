Revision 8: Don't use snprintf - it's not portable.